<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>drawing</title>
    </head>
    <body>
        <script type="text/javascript">
            var link = document.createElement('a'),
                // Work out the path for the links by trimming '[index.html]' + query string from the current page url
                base_url = window.location.href.replace(window.location.search, '').replace(/(index\.html)$/, '');

            link.textContent = 'drawing';
            link.href = 'javascript:(' + encodeURI((function() {
                function load_script(script_name, done) {
                    var script = document.createElement('script');
                    script.type = 'text/javascript';
                    script.src = 'BASE_URL/' + script_name;
                    script.onload = script.onerror = done;
                    document.body.appendChild(script);
                }
                
                load_script('drawing.js', function() {
                    load_script('drawify.js', function() {
                        load_script('socket.io/socket.io.js', function() {
                           var socket = io();
                           socket.on('ready', function(id) {
                               // TODO: Update drawify
                               drawify(socket, id);
                           });
                        });
                    });
                });
            }).toString().replace('BASE_URL', base_url).replace(/[\r\n]|\s\s/g, '')) + ')()';
            // Trim unnecessary whitespace from function and uri-encode it to create the link href

            document.body.appendChild(link);
        </script>
    </body>
</html>
